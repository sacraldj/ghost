# üö® GHOST - –ë–æ–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è v2.0 (–ò—Ç–æ–≥)

## ‚úÖ **–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è 24/7 —Ä–∞–±–æ—Ç—ã**

### **üîó –ê–Ω—Ç–∏-–¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
- ‚úÖ **Topic Hash —Å–∏—Å—Ç–µ–º–∞**: `sha1(lower(strip(title)) + url_root + symbol + date_bucket)`
- ‚úÖ **UPSERT —Å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–µ–π**: `INSERT OR REPLACE INTO critical_news`
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 0 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ "–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É"

### **‚ö° –†–µ–π—Ç-–ª–∏–º–∏—Ç–µ—Ä + Backoff**
- ‚úÖ **Exponential Backoff**: `2^failures` —Å –º–∞–∫—Å–∏–º—É–º–æ–º 10x
- ‚úÖ **Circuit Breaker**: open/half-open/close —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ **Per-source —Ç–æ–∫–µ–Ω—ã**: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 0 –±–∞–Ω–æ–≤ –æ—Ç API

### **üìä –û–∫–Ω–æ –¥–ª—è "¬±2%"**
- ‚úÖ **–Ø–≤–Ω–æ–µ –æ–∫–Ω–æ**: 60-120 —Å–µ–∫—É–Ω–¥
- ‚úÖ **–ë–∞–∑–∞**: mid/last —Ü–µ–Ω–∞ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è**: —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ > 2%
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 0 —Ñ–∞–ª—å—à-—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –Ω–∞ —Ç–æ–Ω–∫–æ–º —Ä—ã–Ω–∫–µ

### **üß† –£–ª—É—á—à–µ–Ω–Ω—ã–π —Å–µ–Ω—Ç–∏–º–µ–Ω—Ç**
- ‚úÖ **Per-source bias**: –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É
- ‚úÖ **–†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞**: –≤–∞–π—Ç–ª–∏—Å—Ç SEC, CFTC, Fed –∏ —Ç.–¥.
- ‚úÖ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ BTC, ETH, SOL
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —Ç–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π

### **üì± –ê–ª–µ—Ä—Ç-—É—Å—Ç–∞–ª–æ—Å—Ç—å**
- ‚úÖ **–°–≥—É—â–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π**: ¬´N —Å–æ–±—ã—Ç–∏–π –∑–∞ M –º–∏–Ω—É—Ç ‚Üí –æ–¥–∏–Ω —Å–≤–æ–¥–Ω—ã–π –∞–ª–µ—Ä—Ç¬ª
- ‚úÖ **–¢–æ—Ä–º–æ–∑ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ**: 5 –º–∏–Ω—É—Ç –º–µ–∂–¥—É –∞–ª–µ—Ä—Ç–∞–º–∏ –Ω–∞ –æ–¥–Ω—É —Ç–µ–º—É
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 0 –∞–ª–µ—Ä—Ç-—É—Å—Ç–∞–ª–æ—Å—Ç–∏

### **üíæ SQLite –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π**
- ‚úÖ **WAL —Ä–µ–∂–∏–º**: `PRAGMA journal_mode=WAL`
- ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã**: `critical_news(source,published_at DESC)`, `critical_news(symbol,published_at)`
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã, 0 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

### **‚è∞ –í—Ä–µ–º—è –∏ —á–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞**
- ‚úÖ **UTC –≤–µ–∑–¥–µ**: `datetime.now(timezone.utc)`
- ‚úÖ **ISO 8601**: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ "–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É"

### **üßπ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
- ‚úÖ **–û—á–∏—Å—Ç–∫–∞ HTML/—ç–º–æ–¥–∑–∏**: `re.sub(r'<[^>]+>', '', text)`
- ‚úÖ **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–º–≤–æ–ª–æ–≤**: WIF ‚Üí WIFUSDT
- ‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–∫–∏–Ω–≥-–∫–æ–¥–æ–≤**: `utm_*` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —á–∏—Å—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

### **üöÄ –¢–µ—Å—Ç—ã "–Ω–∞ —Ö–æ–ª–æ–¥–Ω–æ–º —Å—Ç–∞—Ä—Ç–µ"**
- ‚úÖ **Last seen ID**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ **Health —Å—Ç–∞—Ç—É—Å—ã**: healthy/degraded/failed
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ –Ω–µ –≤—ã—Å—ã–ø–∞—Ç—å 300 —Å—Ç–∞—Ä—ã—Ö ¬´BREAKING¬ª

---

## üìä **API —É–ª—É—á—à–µ–Ω–∏—è**

### **–§–∏–ª—å—Ç—Ä—ã –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è:**
```bash
# –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
GET /api/critical-news-v2?limit=20

# –¢–æ–ª—å–∫–æ BTC –Ω–æ–≤–æ—Å—Ç–∏
GET /api/critical-news-v2?symbols=BTC&limit=10

# –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
GET /api/critical-news-v2?regulatory_only=true&since=2024-01-01T12:00:00Z

# –ù–æ–≤–æ—Å—Ç–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ü–µ–Ω—ã > 5%
GET /api/critical-news-v2?price_change_min=5.0
```

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit`: 1-100 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20)
- `offset`: –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `symbols`: BTC,ETH,SOL (–º–∞—Å—Å–∏–≤ —Å–∏–º–≤–æ–ª–æ–≤)
- `sources`: binance_price,breaking_news (–º–∞—Å—Å–∏–≤ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
- `since`: ISO 8601 timestamp
- `severity`: 1-5 (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- `regulatory_only`: true/false
- `price_change_min`: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã

---

## üõ†Ô∏è **–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∫–∏**

### **DB –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```sql
-- WAL —Ä–µ–∂–∏–º
PRAGMA journal_mode=WAL
PRAGMA synchronous=NORMAL
PRAGMA busy_timeout=5000

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX IF NOT EXISTS idx_critical_news_source_published ON critical_news(source_name, published_at DESC)
CREATE INDEX IF NOT EXISTS idx_critical_news_symbol_published ON critical_news(symbol, published_at)
CREATE INDEX IF NOT EXISTS idx_critical_news_topic_hash ON critical_news(topic_hash)
```

### **–õ–æ–≥–∏/–º–µ—Ç—Ä–∏–∫–∏:**
- ‚úÖ –°—á—ë—Ç—á–∏–∫–∏ pull_ok/pull_fail
- ‚úÖ Latency p50/p95
- ‚úÖ Dedup_rate
- ‚úÖ Alerts_emitted/min

---

## üöÄ **–ó–∞–ø—É—Å–∫ –±–æ–µ–≤–æ–π –≤–µ—Ä—Å–∏–∏**

### **1. –ó–∞–ø—É—Å–∫:**
```bash
./start_critical_engine_v2.sh
```

### **2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
```bash
tail -f news_engine/critical_engine_v2.log
```

### **3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
./stop_critical_engine_v2.sh
```

### **4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API:**
```bash
curl "http://localhost:3001/api/critical-news-v2?limit=5"
```

---

## üìà **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞**

### **–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:**
- ‚úÖ **0 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** –ø—Ä–∏ "–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É"
- ‚úÖ **0 –±–∞–Ω–æ–≤** –æ—Ç API (—Ä–µ–π—Ç-–ª–∏–º–∏—Ç–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ **0 —Ñ–∞–ª—å—à-—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤** (¬±2% –æ–∫–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ **0 –∞–ª–µ—Ä—Ç-—É—Å—Ç–∞–ª–æ—Å—Ç–∏** (—Å–≥—É—â–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã** (WAL + –∏–Ω–¥–µ–∫—Å—ã)
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—Ä–µ–º—è** (UTC –≤–µ–∑–¥–µ)
- ‚úÖ **–ß–∏—Å—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç** (–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç)

---

## üéØ **–ß—Ç–æ –¥–∞–ª—å—à–µ**

### **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ–µ–≤—É—é –≤–µ—Ä—Å–∏—é**: `./start_critical_engine_v2.sh`
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API**: `curl "http://localhost:3001/api/critical-news-v2"`
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏**: `tail -f news_engine/critical_engine_v2.log`
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏** (Binance, NewsAPI)
5. **–î–æ–±–∞–≤–∏—Ç—å Telegram –±–æ—Ç–∞** –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### **–ì–æ—Ç–æ–≤–æ –∫ 24/7 —Ä–∞–±–æ—Ç–µ:**
- ‚úÖ –ê–Ω—Ç–∏-–¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚úÖ –†–µ–π—Ç-–ª–∏–º–∏—Ç–∏–Ω–≥
- ‚úÖ Circuit breaker
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ WAL —Ä–µ–∂–∏–º SQLite
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã
- ‚úÖ –ê–ª–µ—Ä—Ç-—É—Å—Ç–∞–ª–æ—Å—Ç—å
- ‚úÖ –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞
- ‚úÖ –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏

**GHOST –≥–æ—Ç–æ–≤ –∫ –±–æ–µ–≤–æ–π —Ä–∞–±–æ—Ç–µ!** üö®üìä
